Exportfile for AOT version 1.0 or later
Formatversion: 1

***Element: DBT

; Microsoft Dynamics Table : DEV_CleanupTaskSettings unloaded
; --------------------------------------------------------------------------------
  TABLEVERSION 1
  
  TABLE #DEV_CleanupTaskSettings
    PROPERTIES
      Name                #DEV_CleanupTaskSettings
      Label               #Cleanup settings
      Table               #DEV_CleanupTaskSettings
      TitleField1         #CleanupTaskName
      TitleField2         #Description
      CacheLookup         #NotInTTS
      CreateRecIdIndex    #Yes
      SaveDataPerCompany  #No
      TableGroup          #Group
      PrimaryIndex        #CleanupTaskNameIdx
      ClusterIndex        #CleanupTaskNameIdx
      ModifiedBy          #Yes
      CreatedBy           #Yes
    ENDPROPERTIES
    
    FIELDS
      FIELD #CleanupDays
        INT
        PROPERTIES
          Name                #CleanupDays
          Label               #Cleanup days
          HelpText            #Number of days from the current date to keep the data
          Mandatory           #Yes
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #Days
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #CleanupTaskName
        STRING
        PROPERTIES
          Name                #CleanupTaskName
          Mandatory           #Yes
          AllowEdit           #No
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #DEV_CleanUpTaskName
              #
            ENDARRAY
          StringSize          #60
        ENDPROPERTIES
        
      FIELD #Description
        STRING
        PROPERTIES
          Name                #Description
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #Description
              #
            ENDARRAY
          StringSize          #60
        ENDPROPERTIES
        
      FIELD #Enabled
        ENUM
        PROPERTIES
          Name                #Enabled
          HelpText            #Run the task
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #NoYesId
              #
            ENDARRAY
          EnumType            #NoYes
        ENDPROPERTIES
        
      FIELD #LastUpdatedRecords
        INT
        PROPERTIES
          Name                #LastUpdatedRecords
          Label               #Deleted records
          HelpText            #Last deleted records
          AllowEdit           #No
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #PositiveNumber
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #StepDeleteRecords
        INT
        PROPERTIES
          Name                #StepDeleteRecords
          Label               #Delete records per step
          HelpText            #Number of records to delete per step(often 1-10k)
          Mandatory           #Yes
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #PositiveNumber
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #StepSelectRecords
        INT
        PROPERTIES
          Name                #StepSelectRecords
          Label               #Select records per step
          HelpText            #Number of records to select per step(often 1m)
          Mandatory           #Yes
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #PositiveNumber
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #StepLoopMaxCount
        INT
        PROPERTIES
          Name                #StepLoopMaxCount
          Label               #Max steps (0 - unlimited)
          HelpText            #Max loop count for delete (0 - unlimited)
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #PositiveNumber
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #LastSelectRows
        INT
        PROPERTIES
          Name                #LastSelectRows
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #PositiveNumber
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #ClassName
        STRING
        PROPERTIES
          Name                #ClassName
          Label               #Class name
          HelpText            #Class name that performs a cleanup
          Mandatory           #Yes
          AllowEditOnCreate   #No
          AllowEdit           #No
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #NotesLine
              #
            ENDARRAY
          StringSize          #254
        ENDPROPERTIES
        
      FIELD #LastBeginDate
        DATE
        PROPERTIES
          Name                #LastBeginDate
          Label               #Last Begin Date
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #TransDate
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #LastEndDate
        DATE
        PROPERTIES
          Name                #LastEndDate
          Label               #Last End Date
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #TransDate
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #LastBeginDateTime
        TIME
        PROPERTIES
          Name                #LastBeginDateTime
          Label               #Last Begin Time
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #TimeHour24
              #
            ENDARRAY
        ENDPROPERTIES
        
      FIELD #LastEndDateTime
        TIME
        PROPERTIES
          Name                #LastEndDateTime
          Label               #Last End Time
          Table               #DEV_CleanupTaskSettings
          ExtendedDataType    
            ARRAY 
              #TimeHour24
              #
            ENDARRAY
        ENDPROPERTIES
        
    ENDFIELDS
    GROUPS
      GROUP #AutoReport
        PROPERTIES
          Name                #AutoReport
        ENDPROPERTIES
        
        GROUPFIELDS
          #CleanupTaskName
          #Description
          #CleanupDays
          #StepSelectRecords
          #StepDeleteRecords
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #AutoLookup
        PROPERTIES
          Name                #AutoLookup
        ENDPROPERTIES
        
        GROUPFIELDS
          #CleanupTaskName
          #Description
          #CleanupDays
          #StepSelectRecords
          #StepDeleteRecords
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #AdvancedSettings
        PROPERTIES
          Name                #AdvancedSettings
        ENDPROPERTIES
        
        GROUPFIELDS
          #StepSelectRecords
          #StepDeleteRecords
          #StepLoopMaxCount
          #ClassName
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Overview
        PROPERTIES
          Name                #Overview
          Label               #Overview
        ENDPROPERTIES
        
        GROUPFIELDS
          #Enabled
          #CleanupTaskName
          #Description
          #CleanupDays
          #durationMin
          #LastUpdatedRecords
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #StatusHistory
        PROPERTIES
          Name                #StatusHistory
        ENDPROPERTIES
        
        GROUPFIELDS
          #LastUpdatedRecords
          #LastBeginDate
          #LastBeginDateTime
          #LastEndDate
          #LastEndDateTime
        ENDGROUPFIELDS
      ENDGROUP
    ENDGROUPS
    
    INDICES
      #CleanupTaskNameIdx
      PROPERTIES
        Name                #CleanupTaskNameIdx
        AllowDuplicates     #No
      ENDPROPERTIES
      
      INDEXFIELDS
        #CleanupTaskName
      ENDINDEXFIELDS
      
    ENDINDICES
    REFERENCES
    ENDREFERENCES
    
    DELETEACTIONS
    ENDDELETEACTIONS
    
    METHODS
      Version: 3
      SOURCE #durationMin
        #display RealBase durationMin()
        #{
        #    RealBase res;
        #    ;
        #    if (this.LastBeginDate && this.LastEndDate)
        #    {
        #        res = any2real((this.LastEndDateTime - this.LastBeginDateTime) / 60) +
        #                ((this.LastEndDate - this.LastBeginDate) * 1440);
        #    }
        #
        #    return res;
        #}
      ENDSOURCE
      SOURCE #find
        #public static DEV_CleanupTaskSettings find(DEV_CleanUpTaskName _cleanupTaskName,
        #                                           boolean             _forUpdate = false)
        #{
        #    DEV_CleanupTaskSettings DEV_CleanupTaskSettings;
        #
        #    if (_cleanupTaskName)
        #    {
        #        DEV_CleanupTaskSettings.selectForUpdate(_forUpdate);
        #
        #        select firstonly DEV_CleanupTaskSettings
        #            where DEV_CleanupTaskSettings.CleanupTaskName == _cleanupTaskName;
        #    }
        #
        #    return DEV_CleanupTaskSettings;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDTABLE
  

***Element: UTS

; Microsoft Dynamics String: DEV_CleanUpTaskName unloaded
; --------------------------------------------------------------------------------
  USERTYPEVERSION 6
  
  USERTYPE #DEV_CleanUpTaskName
  STRING
    PROPERTIES
      Name                #DEV_CleanUpTaskName
      Label               #CleanUp Task
      HelpText            #CleanUp Task Name
      Extends             #Name
      StringSize          #60
    ENDPROPERTIES
    
    TYPEELEMENTS
    ENDTYPEELEMENTS
    
    TYPEREFERENCES
      TYPEREFERENCETYPE DATASET
      PROPERTIES
        Table               #DEV_CleanupTaskSettings
        RelatedField        #CleanupTaskName
      ENDPROPERTIES
      
    ENDTYPEREFERENCES
    
  ENDUSERTYPE
  

***Element: DBE

; Microsoft Dynamics Enumtype : DEV_CleanupRunMode unloaded
; --------------------------------------------------------------------------------
  ENUMTYPEVERSION 1
  
  ENUMTYPE #DEV_CleanupRunMode
    PROPERTIES
      Name                #DEV_CleanupRunMode
      Label               #Cleanup run mode
      Help                #Cleanup run mode to execute
      UseEnumValue        #Yes
    ENDPROPERTIES
    
    TYPEELEMENTS
      #Run
      PROPERTIES
        Name                #Run
        Label               #Run
        EnumValue           #0
      ENDPROPERTIES
      
      #Init
      PROPERTIES
        Name                #Init
        Label               #Init
        EnumValue           #1
      ENDPROPERTIES
      
      #Estimate
      PROPERTIES
        Name                #Estimate
        Label               #Estimate
        EnumValue           #2
      ENDPROPERTIES
      
      #DisplaySQL
      PROPERTIES
        Name                #DisplaySQL
        Label               #DisplaySQL
        EnumValue           #3
      ENDPROPERTIES
      
    ENDTYPEELEMENTS
  ENDENUMTYPE
  

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTask_SalesParmTables unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTask_SalesParmTables
    PROPERTIES
      Name                #DEV_CleanupDataTask_SalesParmTables
      Extends             #DEV_CleanupDataTaskBase
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #classDeclaration
        #class DEV_CleanupDataTask_SalesParmTables extends DEV_CleanupDataTaskBase
        #{
        #}
      ENDSOURCE
      SOURCE #execute
        #void execute()
        #{
        #    str             sSQL;
        #    str             sEstimatedSQL;
        #    str             sqlTableName;
        #    int             lastRowsProcessed;
        #    int             estimatedRecords;
        #    str             sDateCondition;
        #    str             sMainTableFieldList;
        #
        #    DEV_CleanupDataSQLBuider        sqlBuider;
        #
        #    ;
        #    sqlTableName = tableStr(SalesParmTable);
        #    sEstimatedSQL = strFmt('FROM [dbo].%1 AS MainTable          \n',   sqlTableName);          //TABLE HERE
        #    sEstimatedSQL += strFmt('where (([%1] = %2) OR ([%1] = %3) OR ( ' +
        #                    '([%1] = %4) AND EXISTS (SELECT t.SalesId FROM %5 t where t.SalesId = MainTable.SalesId and t.DataAreaId = MainTable.DataAreaId and t.%6 = %7) )) ',
        #                            fieldstr(SalesParmTable, ParmJobStatus),
        #                            any2int(ParmJobStatus::Executed),
        #                            any2int(ParmJobStatus::ContainErrors),
        #                            any2int(ParmJobStatus::Waiting),        //4
        #                            tableStr(SalesTable),
        #                            fieldstr(SalesTable, SalesStatus),     //6
        #                            any2int(SalesStatus::Invoiced)
        #                            );
        #    sDateCondition = strFmt('(GETDATE() - %1) ',int2str(cleanupTaskSettings.CleanupDays));
        #
        #    sEstimatedSQL += strFmt('AND %1 < %2 ', fieldstr(SalesParmTable, CreatedDate), sDateCondition);
        #    //sEstimatedSQL += strFmt(' AND NOT EXISTS(SELECT t.ParmId FROM %1 t where t.ParmId = MainTable.ParmId and t.DataAreaId = MainTable.DataAreaId and t.%2 >= %3) ',
        #    //            sqlTableName, fieldstr(SalesParmTable, CreatedDateTime), sDateCondition);
        #
        #    if (cleanupRunMode == DEV_CleanupRunMode::Estimate)
        #    {
        #        sSQL = 'SELECT COUNT(*) ';
        #        sSQL +=  sEstimatedSQL;
        #        info(sSQL);
        #        estimatedRecords = this.sqlExecuteQuery(sSQL);
        #        info(strFmt('Number of records: %1', estimatedRecords));
        #
        #        return;
        #    }
        #
        #    this.logBegin(cleanupTaskSettings);
        #
        #    sqlBuider = DEV_CleanupDataSQLBuider::construct(cleanupTaskSettings);
        #
        #    sMainTableFieldList = 'RECID, ParmId, TableRefId, DataAreaId';
        #    sqlBuider.setMainTableSelectFieldList(sMainTableFieldList);
        #
        #    do
        #    {
        #        sSQL = sqlBuider.buildSelectBufferSelectInto(sEstimatedSQL);
        #
        #
        #        //create delete buffer
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoStart();
        #
        #        //    --------------------------------------------------------------
        #        //SalesParmUpdate
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(SalesParmUpdate), sqlBuider.tmpDeleteBuffer(),
        #                                               [fieldstr(SalesParmUpdate, ParmId), 'ParmId'],
        #                                               'MainTable.LATESELECTION = 0');
        #
        #        //SalesParmSubTable
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(SalesParmSubTable), sqlBuider.tmpDeleteBuffer(),
        #                                               [fieldstr(SalesParmSubTable, ParmId),    'ParmId',
        #                                                fieldstr(SalesParmSubTable, TableRefId),'TableRefId']);
        #
        #        //SalesParmLine - delete
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(SalesParmLine), sqlBuider.tmpDeleteBuffer(),
        #                                                     [fieldstr(SalesParmLine, ParmId),     'ParmId',
        #                                                      fieldstr(SalesParmLine, TableRefId), 'TableRefId']);
        #
        #        //SalesParmTable
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(SalesParmTable), sqlBuider.tmpDeleteBuffer(),
        #                                         [fieldstr(SalesParmTable, ParmId),     'ParmId',
        #                                          fieldstr(SalesParmTable, TableRefId), 'TableRefId']);
        #
        #        // ---------------------
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoEnd();
        #
        #        this.sqlExecuteUpdate(sSQL);
        #
        #        lastRowsProcessed = this.getLastProcessedRecords(cleanupTaskSettings);
        #        this.logAddRecords(cleanupTaskSettings, lastRowsProcessed);
        #
        #    } while(this.checkContinueLoop(cleanupTaskSettings, lastRowsProcessed));
        #
        #    this.logEnd(cleanupTaskSettings);
        #}
      ENDSOURCE
      SOURCE #getTaskName
        #public DEV_CleanUpTaskName getTaskName()
        #{
        #    ;
        #    return 'SalesParmTables';
        #}
      ENDSOURCE
      SOURCE #initDefaultParameters
        #public void initDefaultParameters(DEV_CleanupTaskSettings _taskSettings)
        #{
        #    ;
        #    super(_taskSettings);
        #    _taskSettings.CleanupDays = 93;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTask_InventSumClosed unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTask_InventSumClosed
    PROPERTIES
      Name                #DEV_CleanupDataTask_InventSumClosed
      Extends             #DEV_CleanupDataTaskBase
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #classDeclaration
        #class DEV_CleanupDataTask_InventSumClosed extends DEV_CleanupDataTaskBase
        #{
        #}
      ENDSOURCE
      SOURCE #execute
        #void execute()
        #{
        #    str             sSQL;
        #    str             sEstimatedSQL;
        #    str             sqlTableName;
        #    int             lastRowsProcessed;
        #    int             estimatedRecords;
        #    str             sDateCondition;
        #    str             sMainTableFieldList;
        #
        #    DEV_CleanupDataSQLBuider        sqlBuider;
        #    ;
        #
        #    sqlTableName = tableStr(InventSum);
        #    sEstimatedSQL = strFmt('FROM [dbo].%1 AS MainTable          \n',   sqlTableName);          //TABLE HERE
        #
        #    sDateCondition = strFmt('(GETDATE() - %1) ',int2str(cleanupTaskSettings.CleanupDays));
        #
        #    sEstimatedSQL += strFmt('where ([%1] = 1) AND (%3 < %2) AND (%4 < %2)',
        #                            fieldstr(InventSum, Closed),
        #                            sDateCondition,
        #                            fieldstr(InventSum, LastUpdDatePhysical),
        #                            fieldstr(InventSum, LastUpdDateExpected)
        #                            );
        #
        #    if (cleanupRunMode == DEV_CleanupRunMode::Estimate)
        #    {
        #        sSQL = 'SELECT COUNT(*) ';
        #        sSQL +=  sEstimatedSQL;
        #        info(sSQL);
        #        estimatedRecords = this.sqlExecuteQuery(sSQL);
        #        info(strFmt('Number of records: %1', estimatedRecords));
        #
        #        return;
        #    }
        #
        #    this.logBegin(cleanupTaskSettings);
        #
        #    sqlBuider = DEV_CleanupDataSQLBuider::construct(cleanupTaskSettings);
        #
        #    sMainTableFieldList = 'RECID, ItemId, InventDimId, DataAreaId';
        #    sqlBuider.setMainTableSelectFieldList(sMainTableFieldList);
        #
        #    do
        #    {
        #        sSQL = sqlBuider.buildSelectBufferSelectInto(sEstimatedSQL);
        #
        #        //create delete buffer
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoStart();
        #
        #        //    --------------------------------------------------------------
        #        //InventSum
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(InventSum), sqlBuider.tmpDeleteBuffer(),
        #                                               [fieldstr(InventSum, ItemId),      'ItemId',
        #                                                fieldstr(InventSum, InventDimId), 'InventDimId']);
        #
        #
        #        // ---------------------
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoEnd();
        #
        #        this.sqlExecuteUpdate(sSQL);
        #
        #        lastRowsProcessed = this.getLastProcessedRecords(cleanupTaskSettings);
        #        this.logAddRecords(cleanupTaskSettings, lastRowsProcessed);
        #
        #    } while(this.checkContinueLoop(cleanupTaskSettings, lastRowsProcessed));
        #
        #    this.logEnd(cleanupTaskSettings);
        #}
      ENDSOURCE
      SOURCE #getTaskName
        #public DEV_CleanUpTaskName getTaskName()
        #{
        #    ;
        #    return 'InventSumClosed';
        #}
      ENDSOURCE
      SOURCE #initDefaultParameters
        #public void initDefaultParameters(DEV_CleanupTaskSettings _taskSettings)
        #{
        #    ;
        #    super(_taskSettings);
        #    _taskSettings.CleanupDays = 93;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTask_BatchHistory unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTask_BatchHistory
    PROPERTIES
      Name                #DEV_CleanupDataTask_BatchHistory
      Extends             #DEV_CleanupDataTaskBase
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #classDeclaration
        #class DEV_CleanupDataTask_BatchHistory extends DEV_CleanupDataTaskBase
        #{
        #}
      ENDSOURCE
      SOURCE #execute
        #void execute()
        #{
        #    str             sSQL;
        #    str             sEstimatedSQL;
        #    str             sqlTableName;
        #    int             lastRowsProcessed;
        #    int             estimatedRecords;
        #    str             sDateCondition;
        #    DEV_CleanupDataSQLBuider        sqlBuider;
        #    ;
        #
        #    sqlTableName = tableStr(Batch);
        #    sEstimatedSQL = strFmt('FROM [dbo].%1  AS MainTable   \n',   sqlTableName);          //TABLE HERE
        #
        #    sDateCondition = strFmt('(GETDATE() - %1) ',int2str(cleanupTaskSettings.CleanupDays));
        #    sEstimatedSQL += strFmt('WHERE (%1 < %2 ) AND ((%3 = %4) OR (%3 = %5)) ',
        #            fieldstr(Batch, EndDate), sDateCondition, fieldstr(Batch, Status),
        #                any2int(BatchStatus::Error), any2int(BatchStatus::Finished));
        #
        #
        #    if (cleanupRunMode == DEV_CleanupRunMode::Estimate)
        #    {
        #        sSQL = 'SELECT COUNT(*) ';
        #        sSQL +=  sEstimatedSQL;
        #        info(sSQL);
        #        estimatedRecords = this.sqlExecuteQuery(sSQL);
        #        info(strFmt('Number of records: %1', estimatedRecords));
        #
        #        return;
        #    }
        #
        #    this.logBegin(cleanupTaskSettings);
        #
        #    sqlBuider = DEV_CleanupDataSQLBuider::construct(cleanupTaskSettings);
        #
        #    sqlBuider.setMainTableSelectFieldList('RECID, DATAAREAID ');
        #
        #
        #    do
        #    {
        #        sSQL = sqlBuider.buildSelectBufferSelectInto(sEstimatedSQL);
        #
        #
        #        //create delete buffer
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoStart();
        #
        #
        #        //    --------------------------------------------------------------
        #        //BatchHistory
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(Batch), sqlBuider.tmpDeleteBuffer(),
        #                                           [fieldstr(Batch, RecId),     'RECID']);
        #
        #        // ---------------------
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoEnd();
        #
        #        this.sqlExecuteUpdate(sSQL);
        #
        #        lastRowsProcessed = this.getLastProcessedRecords(cleanupTaskSettings);
        #        this.logAddRecords(cleanupTaskSettings, lastRowsProcessed);
        #
        #    } while(this.checkContinueLoop(cleanupTaskSettings, lastRowsProcessed));
        #
        #    this.logEnd(cleanupTaskSettings);
        #}
      ENDSOURCE
      SOURCE #getTaskName
        #public DEV_CleanUpTaskName getTaskName()
        #{
        #    ;
        #    return 'BatchHistory';
        #}
      ENDSOURCE
      SOURCE #initDefaultParameters
        #public void initDefaultParameters(DEV_CleanupTaskSettings _taskSettings)
        #{
        #    ;
        #    super(_taskSettings);
        #    _taskSettings.CleanupDays = 93;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTask_SysDatabaseLog unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTask_SysDatabaseLog
    PROPERTIES
      Name                #DEV_CleanupDataTask_SysDatabaseLog
      Extends             #DEV_CleanupDataTaskBase
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #classDeclaration
        #class DEV_CleanupDataTask_SysDatabaseLog extends DEV_CleanupDataTaskBase
        #{
        #}
      ENDSOURCE
      SOURCE #execute
        #void execute()
        #{
        #    str             sSQL;
        #    str             sEstimatedSQL;
        #    str             sqlTableName;
        #    int             lastRowsProcessed;
        #    int             estimatedRecords;
        #    str             sDateCondition;
        #    DEV_CleanupDataSQLBuider        sqlBuider;
        #    ;
        #
        #    sqlTableName = tableStr(SysDataBaseLog);
        #    sEstimatedSQL = strFmt('FROM [dbo].%1  AS MainTable   \n',   sqlTableName);          //TABLE HERE
        #
        #    sDateCondition = strFmt('(GETDATE() - %1) ',int2str(cleanupTaskSettings.CleanupDays));
        #    sEstimatedSQL += strFmt('WHERE %1 < %2 ', fieldstr(SysDataBaseLog, CreatedDate), sDateCondition);
        #
        #
        #    if (cleanupRunMode == DEV_CleanupRunMode::Estimate)
        #    {
        #        sSQL = 'SELECT COUNT(*) ';
        #        sSQL +=  sEstimatedSQL;
        #        info(sSQL);
        #        estimatedRecords = this.sqlExecuteQuery(sSQL);
        #        info(strFmt('Number of records: %1', estimatedRecords));
        #
        #        return;
        #    }
        #
        #    this.logBegin(cleanupTaskSettings);
        #
        #    sqlBuider = DEV_CleanupDataSQLBuider::construct(cleanupTaskSettings);
        #
        #    sqlBuider.setMainTableSelectFieldList('RECID, DATAAREAID ');
        #
        #
        #    do
        #    {
        #        sSQL = sqlBuider.buildSelectBufferSelectInto(sEstimatedSQL);
        #
        #        //create delete buffer
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoStart();
        #
        #        //    --------------------------------------------------------------
        #        //sqlBuider.parmIsIgnoreCompany(true);
        #        //SysDataBaseLog
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(SysDataBaseLog), sqlBuider.tmpDeleteBuffer(),
        #                                               [fieldstr(SysDataBaseLog, RecId), 'RECID']);
        #
        #        // ---------------------
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoEnd();
        #
        #        this.sqlExecuteUpdate(sSQL);
        #
        #        lastRowsProcessed = this.getLastProcessedRecords(cleanupTaskSettings);
        #        this.logAddRecords(cleanupTaskSettings, lastRowsProcessed);
        #
        #    } while(this.checkContinueLoop(cleanupTaskSettings, lastRowsProcessed));
        #
        #    this.logEnd(cleanupTaskSettings);
        #}
      ENDSOURCE
      SOURCE #getTaskName
        #public DEV_CleanUpTaskName getTaskName()
        #{
        #    ;
        #    return 'SysDatabaseLog';
        #}
      ENDSOURCE
      SOURCE #initDefaultParameters
        #public void initDefaultParameters(DEV_CleanupTaskSettings _taskSettings)
        #{
        #    ;
        #    super(_taskSettings);
        #    _taskSettings.CleanupDays = 400;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTask_PurchParmTable unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTask_PurchParmTable
    PROPERTIES
      Name                #DEV_CleanupDataTask_PurchParmTable
      Extends             #DEV_CleanupDataTaskBase
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #classDeclaration
        #class DEV_CleanupDataTask_PurchParmTable extends DEV_CleanupDataTaskBase
        #{
        #}
      ENDSOURCE
      SOURCE #execute
        #void execute()
        #{
        #    str             sSQL;
        #    str             sEstimatedSQL;
        #    str             sqlTableName;
        #    int             lastRowsProcessed;
        #    int             estimatedRecords;
        #    str             sDateCondition;
        #    DEV_CleanupDataSQLBuider        sqlBuider;
        #    ;
        #    sqlTableName = tableStr(PurchParmTable);
        #    sEstimatedSQL = strFmt('FROM [dbo].%1  AS MainTable   \n',   sqlTableName);          //TABLE HERE
        #    sEstimatedSQL += strFmt('where (([%1] = %2) OR ([%1] = %3) OR ( ' +
        #                    '([%1] = %4) AND EXISTS (SELECT t.PurchId FROM %5 t where t.PurchId = MainTable.PurchId and t.DataAreaId = MainTable.DataAreaId and t.%6 = %7) )) ',
        #                            fieldstr(PurchParmTable, ParmJobStatus),
        #                            any2int(ParmJobStatus::Executed),
        #                            any2int(ParmJobStatus::ContainErrors),
        #                            any2int(ParmJobStatus::Waiting),        //4
        #                            tableStr(PurchTable),
        #                            fieldstr(PurchTable, PurchStatus),     //6
        #                            any2int(PurchStatus::Invoiced)
        #                            );
        #    sDateCondition = strFmt('(GETDATE() - %1) ',int2str(cleanupTaskSettings.CleanupDays));
        #
        #    sEstimatedSQL += strFmt('AND %1 < %2 ', fieldstr(PurchParmTable, CreatedDate), sDateCondition);
        #
        #    sEstimatedSQL += strFmt(' AND NOT EXISTS(SELECT t.ParmId FROM %1 t where t.ParmId = MainTable.ParmId and t.DataAreaId = MainTable.DataAreaId and t.%2 >= %3) ',
        #                sqlTableName, fieldstr(PurchParmTable, CreatedDate), sDateCondition);
        #
        #    if (cleanupRunMode == DEV_CleanupRunMode::Estimate)
        #    {
        #        sSQL = 'SELECT COUNT(*) ';
        #        sSQL +=  sEstimatedSQL;
        #        info(sSQL);
        #        estimatedRecords = this.sqlExecuteQuery(sSQL);
        #        info(strFmt('Number of records: %1', estimatedRecords));
        #
        #        return;
        #    }
        #
        #    this.logBegin(cleanupTaskSettings);
        #
        #    sqlBuider = DEV_CleanupDataSQLBuider::construct(cleanupTaskSettings);
        #
        #    sSQL = sqlBuider.buildBeginDropTmpTables();
        #    this.sqlExecuteUpdate(sSQL);
        #
        #    sqlBuider.setMainTableSelectFieldList('RECID, ParmId, TableRefId, DataAreaId');
        #
        #
        #    do
        #    {
        #        sSQL = sqlBuider.buildSelectBufferSelectInto(sEstimatedSQL);
        #
        #
        #        //create delete buffer
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoStart();
        #
        #
        #        //    --------------------------------------------------------------
        #        //PurchParmUpdate
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(PurchParmUpdate), sqlBuider.tmpDeleteBuffer(),
        #                                               [fieldstr(PurchParmUpdate, ParmId), 'ParmId'],
        #                                               'MainTable.LATESELECTION = 0');
        #
        #        //PurchParmSubTable
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(PurchParmSubTable), sqlBuider.tmpDeleteBuffer(),
        #                                             [fieldstr(PurchParmSubTable, ParmId),     'ParmId',
        #                                              fieldstr(PurchParmSubTable, TableRefId), 'TableRefId']);
        #
        #        //PurchParmLine - delete
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(PurchParmLine), sqlBuider.tmpDeleteBuffer(),
        #                                                     [fieldstr(PurchParmLine, ParmId),     'ParmId',
        #                                                      fieldstr(PurchParmLine, TableRefId), 'TableRefId']);
        #        //PurchParmTable
        #        sSQL += sqlBuider.buildTmpDeleteCompany(tableStr(PurchParmTable), sqlBuider.tmpDeleteBuffer(),
        #                                           [fieldstr(PurchParmTable, RecId),     'RECID']);
        #
        #        // ---------------------
        #        sSQL += sqlBuider.buildDeleteBufferSelectIntoEnd();
        #
        #        this.sqlExecuteUpdate(sSQL);
        #
        #        lastRowsProcessed = this.getLastProcessedRecords(cleanupTaskSettings);
        #        this.logAddRecords(cleanupTaskSettings, lastRowsProcessed);
        #
        #    } while(this.checkContinueLoop(cleanupTaskSettings, lastRowsProcessed));
        #
        #    this.logEnd(cleanupTaskSettings);
        #}
      ENDSOURCE
      SOURCE #getTaskName
        #public DEV_CleanUpTaskName getTaskName()
        #{
        #    ;
        #    return 'PurchParmTables';
        #}
      ENDSOURCE
      SOURCE #initDefaultParameters
        #public void initDefaultParameters(DEV_CleanupTaskSettings _taskSettings)
        #{
        #    ;
        #    super(_taskSettings);
        #    _taskSettings.CleanupDays = 93;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataSQLBuider unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataSQLBuider
    PROPERTIES
      Name                #DEV_CleanupDataSQLBuider
      Extends             #
      RunOn               #Called from
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #buildBeginDropTmpTables
        #str buildBeginDropTmpTables()
        #{
        #    str             sSQL;
        #
        #    sSQL =  'IF OBJECT_ID(\'tempdb..#tmpSelectBuffer\') IS NOT NULL DROP TABLE #tmpSelectBuffer; \n ';
        #    sSQL += 'IF OBJECT_ID(\'tempdb..#tmpDeleteBuffer\') IS NOT NULL DROP TABLE #tmpDeleteBuffer; \n ';
        #
        #
        #
        #    return sSQL;
        #
        #}
      ENDSOURCE
      SOURCE #buildDeleteBufferSelectIntoEnd
        #str buildDeleteBufferSelectIntoEnd()
        #{
        #    str             sSQL;
        #    ;
        #    sSQL += 'delete from #tmpSelectBuffer from #tmpSelectBuffer as dt inner join #tmpDeleteBuffer as dl on dl.RECID =dt.RECID; \n';
        #
        #    sSQL += 'END  \n';
        #    sSQL += 'DROP TABLE #tmpSelectBuffer;  \n';
        #    sSQL += 'DROP TABLE #tmpDeleteBuffer;  \n';
        #    //sSQL += 'DROP TABLE #tmpRes; \n';
        #
        #
        #    return sSQL;
        #}
      ENDSOURCE
      SOURCE #buildDeleteBufferSelectIntoStart
        #str buildDeleteBufferSelectIntoStart()
        #{
        #    str             sSQL;
        #    //int     i1;
        #    ;
        #    sSQL += strFmt('select top 1 %1 into #tmpDeleteBuffer FROM #tmpSelectBuffer; \n', sMainTableFieldList);
        #
        #    sSQL += 'set @step= 0; \n';
        #    sSQL += strFmt('WHILE (@step < %1) BEGIN \n',  int2str(any2int(roundUp(cleanupTaskSettings.StepSelectRecords / cleanupTaskSettings.StepDeleteRecords, 1))));
        #
        #    sSQL += '    SET @step = @step + 1 \n';
        #
        #    //for(i1 = 1; i1<= 100; i1++)
        #    //{
        #    sSQL +=        '    TRUNCATE TABLE #tmpDeleteBuffer; \n';
        #    sSQL += strFmt('    INSERT INTO #tmpDeleteBuffer(%2) SELECT TOP %1 %2 FROM  #tmpSelectBuffer; \n', cleanupTaskSettings.StepDeleteRecords, sMainTableFieldList);
        #    sSQL += '    IF (@@ROWCOUNT = 0) break; \n';
        #    //}
        #    return sSQL;
        #}
      ENDSOURCE
      SOURCE #buildSelectBufferSelectInto
        #str buildSelectBufferSelectInto(str _estimatedWhereSQL)
        #{
        #    str             sSQL;
        #    sSQL = '';
        #    sSQL += ' \n declare @lastSelectRows int; \n';
        #    sSQL += 'declare @step           int; \n';
        #    sSQL += this.buildBeginDropTmpTables();
        #    sSQL += strFmt(' select top %1 %2 into #tmpSelectBuffer \n', int2str(cleanupTaskSettings.StepSelectRecords), sMainTableFieldList);
        #    sSQL += _estimatedWhereSQL;
        #
        #    sSQL += '\n SET @lastSelectRows = @@ROWCOUNT; \n';
        #    sSQL += strFmt('UPDATE %1 SET %2 = @lastSelectRows WHERE %3=N\'%4\';  \n ',
        #           tablestr(DEV_CleanupTaskSettings),
        #           fieldstr(DEV_CleanupTaskSettings, LastSelectRows),
        #           fieldstr(DEV_CleanupTaskSettings, CleanupTaskName),
        #           cleanupTaskSettings.CleanupTaskName);
        #
        #    sSQL += 'CREATE NONCLUSTERED INDEX [##_RECID] ON #tmpSelectBuffer (RECID ASC); \n';
        #
        #
        #    return sSQL;
        #
        #}
      ENDSOURCE
      SOURCE #buildTmpDeleteCompany
        #str buildTmpDeleteCompany(str _mainTable, str _tmpTable, container _linkedFields, str _additionCondition = '' )
        #{
        #    str res;
        #    ;
        #    res += strFmt('    delete FROM [dbo].%1 ', _mainTable);
        #
        #    res += this.buildTmpSelectCompany(_mainTable, _tmpTable, _linkedFields, _additionCondition);
        #
        #
        #    return res;
        #}
      ENDSOURCE
      SOURCE #buildTmpExistsJoinCompany
        #str buildTmpExistsJoinCompany(str _mainTable, str _tmpTable, container _linkedFields )
        #{
        #    str res;
        #    int i;
        #    ;
        #    res += strFmt(' FROM [dbo].%1  AS MainTable \n', _mainTable);
        #
        #    res += strFmt('    WHERE EXISTS (SELECT \'x\' FROM %1 AS tmpT WHERE  ', _tmpTable);
        #    for (i = 1; i <= conlen(_linkedFields) ; i+=2 )
        #    {
        #        res += strFmt('MainTable.%1 = tmpT.%2 AND ', conpeek(_linkedFields, i), conpeek(_linkedFields, i + 1));
        #    }
        #    res += strFmt('MainTable.DataAreaId = tmpT.DataAreaId );  \n');
        #
        #
        #    return res;
        #}
      ENDSOURCE
      SOURCE #buildTmpSelectCompany
        #str buildTmpSelectCompany(str _mainTable, str _tmpTable, container _linkedFields, str _additionCondition = '' )
        #{
        #    str res;
        #    int i;
        #    ;
        #    res += strFmt(' FROM [dbo].%1  AS MainTable \n', _mainTable);
        #    res += strFmt('    INNER JOIN %1 AS tmpT ON ', _tmpTable);
        #    for (i = 1; i <= conlen(_linkedFields); i+=2 )
        #    {
        #        res += strFmt('MainTable.%1 = tmpT.%2 AND ', conpeek(_linkedFields, i), conpeek(_linkedFields, i + 1));
        #    }
        #    if (! isIgnoreCompany)
        #    {
        #        res += strFmt('MainTable.DataAreaId = tmpT.DataAreaId ');
        #    }
        #    else
        #    {
        #        res += ' 1=1 ';
        #    }
        #    if (_additionCondition)
        #    {
        #        res += strFmt(' \n WHERE %1 ', _additionCondition);
        #    }
        #    res += ' ; \n';
        #
        #
        #    return res;
        #}
      ENDSOURCE
      SOURCE #classDeclaration
        #class DEV_CleanupDataSQLBuider
        #{
        #    DEV_CleanupTaskSettings     cleanupTaskSettings;
        #
        #    str             sMainTableFieldList;
        #
        #    boolean         isIgnoreCompany;
        #}
      ENDSOURCE
      SOURCE #parmCleanupTaskSettings
        #public DEV_CleanupTaskSettings parmCleanupTaskSettings(DEV_CleanupTaskSettings _cleanupTaskSettings = cleanupTaskSettings)
        #{
        #    ;
        #    cleanupTaskSettings = _cleanupTaskSettings;
        #
        #    return cleanupTaskSettings;
        #}
        #
      ENDSOURCE
      SOURCE #parmIsIgnoreCompany
        #public NoYesId parmIsIgnoreCompany(NoYesId _isIgnoreCompany = isIgnoreCompany)
        #{
        #    isIgnoreCompany = _isIgnoreCompany;
        #
        #    return isIgnoreCompany;
        #}
      ENDSOURCE
      SOURCE #setMainTableSelectFieldList
        #void setMainTableSelectFieldList(str  _sMainTableFieldList)
        #{
        #    sMainTableFieldList = _sMainTableFieldList;
        #}
      ENDSOURCE
      SOURCE #tmpDeleteBuffer
        #str tmpDeleteBuffer()
        #{
        #    return '#tmpDeleteBuffer';
        #}
      ENDSOURCE
      SOURCE #construct
        #public static DEV_CleanupDataSQLBuider construct(DEV_CleanupTaskSettings   _cleanupTaskSettings)
        #{
        #    DEV_CleanupDataSQLBuider    res;
        #
        #    res = new DEV_CleanupDataSQLBuider();
        #    res.parmCleanupTaskSettings(_cleanupTaskSettings);
        #
        #    return res;
        #}
        #
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTaskProcessor unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTaskProcessor
    PROPERTIES
      Name                #DEV_CleanupDataTaskProcessor
      Extends             #RunBaseBatch
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #allowSaveLast
        #public boolean allowSaveLast()
        #{
        #    boolean ret;
        #
        #    ret = super();
        #
        #    if (cleanUpTaskNameExternal)
        #    {
        #        ret = false;
        #    }
        #
        #    return ret;
        #}
      ENDSOURCE
      SOURCE #classDeclaration
        #class DEV_CleanupDataTaskProcessor extends RunBaseBatch
        #{
        #    Integer                 dummy;
        #    DEV_CleanUpTaskName     cleanUpTaskNameExternal;
        #
        #    QueryRun                queryRun;
        #
        #    DEV_CleanupRunMode  cleanupRunMode;
        #
        #    #define.CurrentVersion(1)
        #    #localmacro.CurrentList
        #        dummy
        #    #endmacro
        #}
        #
      ENDSOURCE
      SOURCE #dialog
        #public Object dialog()
        #{
        #    DialogRunbase       dialog = super();
        #    ;
        #    if (cleanUpTaskNameExternal)
        #    {
        #        dialog.addText(strFmt("Execute %1", cleanUpTaskNameExternal));
        #    }
        #    //dlgDummy                   = dialog.addFieldValue(extendedtypestr(Integer), dummy);
        #
        #    return dialog;
        #}
        #
      ENDSOURCE
      SOURCE #executeTask
        #void executeTask(DEV_CleanupDataTaskBase  _cleanupDataTaskBase, DEV_CleanupTaskSettings  _cleanupTaskSettings)
        #{
        #    ;
        #    _cleanupDataTaskBase.parmCleanupRunMode(cleanupRunMode);
        #    _cleanupDataTaskBase.parmCleanupTaskSettings(_cleanupTaskSettings);
        #
        #    if (_cleanupTaskSettings.Enabled ||
        #       (cleanupRunMode == DEV_CleanupRunMode::Estimate || cleanupRunMode == DEV_CleanupRunMode::DisplaySQL) )
        #    {
        #        _cleanupDataTaskBase.execute();
        #     }
        #}
      ENDSOURCE
      SOURCE #getFromDialog
        #public boolean getFromDialog()
        #{
        #    ;
        #
        #    //dummy              = dlgDummy.value();
        #
        #    return super();
        #}
        #
      ENDSOURCE
      SOURCE #initParmDefault
        #public void initParmDefault()
        #{
        #    ;
        #
        #    this.initQuery();
        #
        #    super();
        #}
        #
      ENDSOURCE
      SOURCE #initQuery
        #public void initQuery()
        #{
        #    Query                   query = new Query();
        #    QueryBuildDataSource    qbds = query.addDataSource(tablenum(DEV_CleanupTaskSettings));
        #    QueryBuildRange         qBR;
        #    ;
        #
        #    qBR = SysQuery::findOrCreateRange(qbds, fieldnum(DEV_CleanupTaskSettings, CleanupTaskName));
        #    queryRun = new QueryRun(query);
        #}
        #
      ENDSOURCE
      SOURCE #initSettingsForTask
        #DEV_CleanupTaskSettings initSettingsForTask(DEV_CleanupDataTaskBase  _cleanupDataTaskBase)
        #{
        #    DEV_CleanupTaskSettings     cleanupTaskSettings;
        #    DEV_CleanUpTaskName         cleanUpTaskName;
        #    ;
        #    cleanUpTaskName = _cleanupDataTaskBase.getTaskName();
        #    if (! cleanUpTaskName)
        #    {
        #        throw error("Task name is not specified for %1 class", classid2name(classidget(this)));
        #    }
        #
        #    cleanupTaskSettings = DEV_CleanupTaskSettings::find(cleanUpTaskName);
        #    if (! cleanupTaskSettings.RecId)
        #    {
        #        cleanupTaskSettings.CleanupTaskName = cleanUpTaskName;
        #        _cleanupDataTaskBase.initDefaultParameters(cleanupTaskSettings);
        #
        #        if (! cleanupTaskSettings.validateWrite())
        #        {
        #            throw error(strFmt("Failed to init task '%1'", cleanUpTaskName));
        #        }
        #        cleanupTaskSettings.insert();
        #    }
        #    if (cleanupRunMode == DEV_CleanupRunMode::Init)
        #    {
        #        cleanupTaskSettings.Enabled = false;
        #    }
        #
        #    return cleanupTaskSettings;
        #
        #}
      ENDSOURCE
      SOURCE #new
        #public void new()
        #{
        #    super();
        #    this.initQuery();
        #}
      ENDSOURCE
      SOURCE #pack
        #public container pack()
        #{
        #    ;
        #
        #    return [#CurrentVersion, #CurrentList, queryRun.pack()];
        #}
        #
      ENDSOURCE
      SOURCE #parmCleanupRunMode
        #public DEV_CleanupRunMode parmCleanupRunMode(DEV_CleanupRunMode _cleanupRunMode = cleanupRunMode)
        #{
        #    ;
        #    cleanupRunMode = _cleanupRunMode;
        #
        #    return cleanupRunMode;
        #}
        #
      ENDSOURCE
      SOURCE #queryRun
        #public QueryRun queryRun()
        #{
        #    ;
        #
        #    return queryRun;
        #}
        #
      ENDSOURCE
      SOURCE #run
        #public void run()
        #{
        #    QueryBuildDataSource        qBDS;
        #    DEV_CleanupTaskSettings     cleanupTaskSettings;
        #    DEV_CleanupDataTaskBase     cleanupDataTaskBase;
        #    DictClass                   dc;
        #    ;
        #    DEV_CleanupDataTaskProcessor::initTasksSettings();
        #
        #    qBDS = queryRun.query().dataSourceTable(tableNum(DEV_CleanupTaskSettings));
        #
        #    if (cleanUpTaskNameExternal)
        #    {
        #        qbds.clearRanges();
        #        qbds.addRange(fieldnum(DEV_CleanupTaskSettings, CleanupTaskName)).value(queryValue(cleanUpTaskNameExternal));
        #    }
        #
        #    while (queryRun.next())
        #    {
        #        cleanupTaskSettings = queryRun.get(tablenum(DEV_CleanupTaskSettings));
        #        if (classname2id(cleanupTaskSettings.ClassName))
        #        {
        #            dc = new DictClass(classname2id(cleanupTaskSettings.ClassName));
        #            cleanupDataTaskBase = dc.makeObject();
        #            this.executeTask(cleanupDataTaskBase, cleanupTaskSettings);
        #        }
        #
        #    }
        #
        #}
        #
      ENDSOURCE
      SOURCE #setCleanupTaskSettingsExternal
        #public void setCleanupTaskSettingsExternal(DEV_CleanupTaskSettings _cleanupTaskSettingsExternal )
        #{
        #    ;
        #    cleanUpTaskNameExternal = _cleanupTaskSettingsExternal.CleanupTaskName;
        #}
        #
      ENDSOURCE
      SOURCE #showQueryValues
        #public boolean showQueryValues()
        #{
        #    ;
        #
        #    return cleanUpTaskNameExternal ? false : true;
        #}
        #
      ENDSOURCE
      SOURCE #unpack
        #public boolean unpack(container _packedClass)
        #{
        #    Version    version = RunBase::getVersion(_packedClass);
        #    container  queryCon;
        #    ;
        #
        #    switch (version)
        #    {
        #        case #CurrentVersion:
        #            [version,#CurrentList,queryCon] = _packedClass;
        #            if (SysQuery::isPackedOk(queryCon))
        #            {
        #                queryRun = new QueryRun(queryCon);
        #            }
        #            else
        #            {
        #                this.initQuery();
        #            }
        #            break;
        #        default:
        #            return false;
        #    }
        #
        #    return true;
        #}
        #
      ENDSOURCE
      SOURCE #construct
        #public static DEV_CleanupDataTaskProcessor construct()
        #{
        #    return new DEV_CleanupDataTaskProcessor();
        #}
      ENDSOURCE
      SOURCE #description
        #static ClassDescription description()
        #{
        #    ;
        #
        #    return "Cleanup historic data";
        #}
      ENDSOURCE
      SOURCE #initTasksSettings
        #public server static void initTasksSettings()
        #{
        #    DEV_CleanupTaskSettings         cleanupTaskSettings;
        #    DEV_CleanupDataTaskBase         cleanupDataTaskBase;
        #    DictClass                       dc;
        #    DEV_CleanupDataTaskProcessor    cleanupDataTaskProcessor = new DEV_CleanupDataTaskProcessor();
        #    ;
        #    ttsbegin;
        #    while select forupdate cleanupTaskSettings
        #    {
        #        if (classname2id(cleanupTaskSettings.ClassName))
        #        {
        #            dc = new DictClass(classname2id(cleanupTaskSettings.ClassName));
        #            cleanupDataTaskBase = dc.makeObject();
        #        }
        #        else
        #        {
        #            cleanupTaskSettings.delete();
        #        }
        #    }
        #    ttscommit;
        #
        #    cleanupDataTaskProcessor.initSettingsForTask(new DEV_CleanupDataTask_SalesParmTables());
        #    cleanupDataTaskProcessor.initSettingsForTask(new DEV_CleanupDataTask_PurchParmTable());
        #    cleanupDataTaskProcessor.initSettingsForTask(new DEV_CleanupDataTask_InventSumClosed());
        #    cleanupDataTaskProcessor.initSettingsForTask(new DEV_CleanupDataTask_SysDatabaseLog());
        #    cleanupDataTaskProcessor.initSettingsForTask(new DEV_CleanupDataTask_BatchHistory());
        #}
        #
      ENDSOURCE
      SOURCE #main
        #public static void main(Args _args)
        #{
        #    DEV_CleanupDataTaskProcessor   runObject = DEV_CleanupDataTaskProcessor::construct();
        #    DEV_CleanupTaskSettings        cleanupTaskSettingsExt;
        #    FormDataSource                 fds;
        #    ;
        #
        #    if (_args && _args.record() && _args.record().TableId == tablenum(DEV_CleanupTaskSettings))
        #    {
        #        cleanupTaskSettingsExt = _args.record();
        #        runObject.setCleanupTaskSettingsExternal(cleanupTaskSettingsExt);
        #
        #        //runObject.parmIsDisableUnpackQuery(true);
        #    }
        #    if (runObject.prompt())
        #    {
        #        runObject.run();
        #    }
        #    if (cleanupTaskSettingsExt.dataSource())
        #    {
        #        fds = cleanupTaskSettingsExt.dataSource();
        #        fds.research();
        #    }
        #}
        #
      ENDSOURCE
      SOURCE #runDisplaySQL
        #server static void runDisplaySQL(DEV_CleanupTaskSettings _cleanupTaskSettingsExternal)
        #{
        #    DEV_CleanupDataTaskProcessor         runObject = DEV_CleanupDataTaskProcessor::construct();
        #    ;
        #    runObject.setCleanupTaskSettingsExternal(_cleanupTaskSettingsExternal);
        #    runObject.parmCleanupRunMode(DEV_CleanupRunMode::DisplaySQL);
        #    runObject.run();
        #}
      ENDSOURCE
      SOURCE #runEstimate
        #server static void runEstimate(DEV_CleanupTaskSettings _cleanupTaskSettingsExternal)
        #{
        #    DEV_CleanupDataTaskProcessor         runObject = DEV_CleanupDataTaskProcessor::construct();
        #    ;
        #    runObject.setCleanupTaskSettingsExternal(_cleanupTaskSettingsExternal);
        #    runObject.parmCleanupRunMode(DEV_CleanupRunMode::Estimate);
        #    runObject.run();
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: CLS

; Microsoft Dynamics Class: DEV_CleanupDataTaskBase unloaded
; --------------------------------------------------------------------------------
  CLSVERSION 1
  
  CLASS #DEV_CleanupDataTaskBase
    PROPERTIES
      Name                #DEV_CleanupDataTaskBase
      Extends             #
      RunOn               #Server
    ENDPROPERTIES
    
    METHODS
      Version: 3
      SOURCE #checkContinueLoop
        #boolean checkContinueLoop(DEV_CleanupTaskSettings     _cleanupTaskSettings, int _recCount)
        #{
        #    boolean res;
        #    ;
        #    if (cleanupRunMode != DEV_CleanupRunMode::Run)
        #    {
        #        return false;
        #    }
        #    res = (_recCount && _recCount == _cleanupTaskSettings.StepSelectRecords);
        #
        #    curLoopNumber++;
        #
        #    if (_cleanupTaskSettings.StepLoopMaxCount && curLoopNumber >= _cleanupTaskSettings.StepLoopMaxCount )
        #    {
        #        res = false;
        #    }
        #
        #
        #    return res;
        #
        #}
      ENDSOURCE
      SOURCE #classDeclaration
        #class DEV_CleanupDataTaskBase
        #{
        #    DEV_CleanupRunMode          cleanupRunMode;
        #    DEV_CleanupTaskSettings     cleanupTaskSettings;
        #
        #
        #    Connection      connection;
        #    int             curLoopNumber;
        #
        #}
        #
      ENDSOURCE
      SOURCE #execute
        #public void execute()
        #{
        #    ;
        #}
      ENDSOURCE
      SOURCE #getLastProcessedRecords
        #int getLastProcessedRecords(DEV_CleanupTaskSettings     _cleanupTaskSettings)
        #{
        #    ;
        #    _cleanupTaskSettings.reread();
        #
        #    return _cleanupTaskSettings.LastSelectRows;
        #}
      ENDSOURCE
      SOURCE #getTaskName
        #public DEV_CleanUpTaskName getTaskName()
        #{
        #    ;
        #    throw error(Error::missingOverload(funcname()));
        #}
      ENDSOURCE
      SOURCE #initDefaultParameters
        #public void initDefaultParameters(DEV_CleanupTaskSettings _taskSettings)
        #{
        #    ;
        #    _taskSettings.CleanupDays       = 93;
        #    _taskSettings.StepDeleteRecords = 5000;
        #    _taskSettings.StepSelectRecords = 50000;
        #    _taskSettings.Enabled           = true;
        #
        #    _taskSettings.ClassName = classId2name(classIdget(this));
        #}
      ENDSOURCE
      SOURCE #logAddRecords
        #void logAddRecords(DEV_CleanupTaskSettings     _cleanupTaskSettings, int _recCount)
        #{
        #    DEV_CleanupTaskSettings  cleanupTaskSettingsUpd;
        #    ;
        #    if (cleanupRunMode != DEV_CleanupRunMode::Run)
        #    {
        #        return;
        #    }
        #
        #    ttsBegin;
        #
        #    cleanupTaskSettingsUpd = DEV_CleanupTaskSettings::find(_cleanupTaskSettings.CleanupTaskName, true);
        #
        #    cleanupTaskSettingsUpd.LastUpdatedRecords += _recCount;
        #    cleanupTaskSettingsUpd.update();
        #
        #    ttsCommit;
        #}
      ENDSOURCE
      SOURCE #logBegin
        #void logBegin(DEV_CleanupTaskSettings     _cleanupTaskSettings)
        #{
        #    DEV_CleanupTaskSettings  cleanupTaskSettingsUpd;
        #    ;
        #    if (cleanupRunMode != DEV_CleanupRunMode::Run)
        #    {
        #        return;
        #    }
        #    ttsBegin;
        #
        #    cleanupTaskSettingsUpd = DEV_CleanupTaskSettings::find(_cleanupTaskSettings.CleanupTaskName, true);
        #
        #    cleanupTaskSettingsUpd.LastBeginDate      = systemDateGet();
        #    cleanupTaskSettingsUpd.LastBeginDateTime  = timenow();
        #    cleanupTaskSettingsUpd.LastEndDate        = dateNull();
        #    cleanupTaskSettingsUpd.LastEndDateTime    = 0;
        #
        #    cleanupTaskSettingsUpd.LastUpdatedRecords = 0;
        #    cleanupTaskSettingsUpd.update();
        #
        #    ttsCommit;
        #
        #    curLoopNumber = 0;
        #}
      ENDSOURCE
      SOURCE #logEnd
        #void logEnd(DEV_CleanupTaskSettings     _cleanupTaskSettings, int _recCount = 0)
        #{
        #    DEV_CleanupTaskSettings  cleanupTaskSettingsUpd;
        #    ;
        #    if (cleanupRunMode != DEV_CleanupRunMode::Run)
        #    {
        #        return;
        #    }
        #
        #    connection = null;
        #
        #    ttsBegin;
        #
        #    cleanupTaskSettingsUpd = DEV_CleanupTaskSettings::find(_cleanupTaskSettings.CleanupTaskName, true);
        #
        #    cleanupTaskSettingsUpd.LastEndDate      = systemDateGet();
        #    cleanupTaskSettingsUpd.LastEndDateTime  = timenow();
        #
        #    cleanupTaskSettingsUpd.LastUpdatedRecords += _recCount;
        #    cleanupTaskSettingsUpd.update();
        #
        #    ttsCommit;
        #}
      ENDSOURCE
      SOURCE #parmCleanupRunMode
        #public DEV_CleanupRunMode parmCleanupRunMode(DEV_CleanupRunMode _cleanupRunMode = cleanupRunMode)
        #{
        #    ;
        #    cleanupRunMode = _cleanupRunMode;
        #
        #    return cleanupRunMode;
        #}
        #
      ENDSOURCE
      SOURCE #parmCleanupTaskSettings
        #public DEV_CleanupTaskSettings parmCleanupTaskSettings(DEV_CleanupTaskSettings _cleanupTaskSettings = cleanupTaskSettings)
        #{
        #    ;
        #    cleanupTaskSettings = _cleanupTaskSettings;
        #
        #    return cleanupTaskSettings;
        #}
        #
      ENDSOURCE
      SOURCE #sqlExecuteQuery
        #int sqlExecuteQuery(str  _sqlStr)
        #{
        #    int  res;
        #    ResultSet       rs;
        #    SqlStatementExecutePermission       perm;
        #    Statement           statement;
        #
        #    ;
        #
        #    if (cleanupRunMode == DEV_CleanupRunMode::DisplaySQL)
        #    {
        #        info(_sqlStr);
        #        return 0;
        #    }
        #
        #    // create connection object
        #    if (! connection)
        #    {
        #        connection = new Connection();
        #
        #    }
        #    // create statement
        #    if (! statement)
        #    {
        #        statement = connection.createStatement();
        #    }
        #    // assert SQL statement execute permission
        #    perm = new SqlStatementExecutePermission(_sqlStr);
        #    perm.assert();
        #
        #    //info(_sqlStr);
        #
        #    //BP Deviation documented
        #    rs = statement.executeQuery(_sqlStr);
        #    if (rs.next())
        #    {
        #        res = rs.getInt(1);
        #    }
        #    statement.close();
        #    statement = null;
        #
        #    // limit the scope of the assert call
        #    CodeAccessPermission::revertAssert();
        #
        #    return res;
        #}
      ENDSOURCE
      SOURCE #sqlExecuteUpdate
        #void sqlExecuteUpdate(str  _sqlStr)
        #{
        #    Statement           statement;
        #    ;
        #    if (cleanupRunMode == DEV_CleanupRunMode::Init || cleanupRunMode == DEV_CleanupRunMode::Estimate)
        #    {
        #        throw error(error::wrongUseOfFunction(funcName()));
        #    }
        #    if (cleanupRunMode == DEV_CleanupRunMode::DisplaySQL)
        #    {
        #        info(_sqlStr);
        #        return;
        #    }
        #
        #    // create connection object
        #    if (! connection)
        #    {
        #        connection = new Connection();
        #    }
        #    // create statement
        #    statement = connection.createStatement();
        #
        #    // assert SQL statement execute permission
        #    new SqlStatementExecutePermission(_sqlStr).assert();
        #
        #    //BP Deviation documented
        #    statement.executeUpdate(_sqlStr);
        #
        #    statement.close();
        #    statement = null;
        #
        #    // limit the scope of the assert call
        #    CodeAccessPermission::revertAssert();
        #}
      ENDSOURCE
      SOURCE #test
        #server static void test()
        #{
        #    DEV_CleanupDataTaskBase        processor = new DEV_CleanupDataTaskBase();
        #    str     sSQL;
        #    ;
        #    sSQL = 'IF OBJECT_ID(\'tempdb..#tmpRes\')          IS NOT NULL DROP TABLE #tmpRes; \n';
        #    sSQL += 'CREATE TABLE #tmpRes (RECID   BIGINT) \n';
        #    processor.sqlExecuteUpdate(sSQL);
        #    sSQL = '';
        #    processor.sqlExecuteUpdate(sSQL);
        #
        #}
      ENDSOURCE
    ENDMETHODS
  ENDCLASS

***Element: FRM

; Microsoft Dynamics Forms unloaded
; --------------------------------------------------------------------------------
FRMVERSION 5

FORM #DEV_CleanupTaskSettings
  PROPERTIES
    Name                #DEV_CleanupTaskSettings
  ENDPROPERTIES
  
  METHODS
    Version: 3
    SOURCE #classDeclaration
      #public class FormRun extends ObjectRun
      #{
      #}
    ENDSOURCE
    SOURCE #init
      #public void init()
      #{
      #    super();
      #
      #    DEV_CleanupDataTaskProcessor::initTasksSettings();
      #}
    ENDSOURCE
  ENDMETHODS
  OBJECTBANK
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #DEV_CleanupTaskSettings
          Table               #DEV_CleanupTaskSettings
          AllowCreate         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
    ENDDATASOURCE
  ENDOBJECTBANK
  
  JOINS
  ENDJOINS
  
  DESIGN
    PROPERTIES
      Width               #Column width
      Height              #Column height
      TitleDatasource     #DEV_CleanupTaskSettings
      SaveSize            #Yes
      SetCompany          #No
      DataSource          #DEV_CleanupTaskSettings
    ENDPROPERTIES
    
    CONTAINER
      CONTROL TAB
        ;==== controlId:12290, containerId: 0, containerdata:117   
        ;----------------------------------------------------------
        PROPERTIES
          Name                #Tab
          Width               #Column width
          Height              #Column height
          DataSource          #DEV_CleanupTaskSettings
        ENDPROPERTIES
        
        CONTAINER
          CONTROL TABPAGE
            ;==== controlId:12291, containerId:12290, containerdata:12290   
            ;----------------------------------------------------------
            PROPERTIES
              Name                #TabPageOverview
              Width               #Column width
              Height              #Column height
              Caption             #@SYS9039
            ENDPROPERTIES
            
            CONTAINER
              CONTROL GRID
                ;==== controlId:12292, containerId:12291, containerdata:12291   
                ;----------------------------------------------------------
                PROPERTIES
                  Name                #Grid
                  Width               #Column width
                  Height              #Column height
                  DataSource          #DEV_CleanupTaskSettings
                ENDPROPERTIES
                
                  CONTAINER
                    CONTROL GROUP
                      ;==== controlId:12293, containerId:12292, containerdata:12292   
                      ;----------------------------------------------------------
                      PROPERTIES
                        Name                #Overview
                        BackgroundColor     #Window background
                        DataSource          #DEV_CleanupTaskSettings
                        DataGroup           #Overview
                      ENDPROPERTIES
                      
                        CONTAINER
                          CONTROL CHECKBOX
                            ;==== controlId:12294, containerId:12293, containerdata:12293   
                            ;----------------------------------------------------------
                            PROPERTIES
                              Name                #Overview_Enabled
                              DataSource          #DEV_CleanupTaskSettings
                              DataField           #Enabled
                            ENDPROPERTIES
                            
                          ENDCONTROL 
                          
                          CONTROL STRINGEDIT
                            ;==== controlId:12295, containerId:12293, containerdata:12293   
                            ;----------------------------------------------------------
                            PROPERTIES
                              Name                #Overview_CleanupTaskName
                              DataSource          #DEV_CleanupTaskSettings
                              DataField           #CleanupTaskName
                            ENDPROPERTIES
                            
                          ENDCONTROL 
                          
                          CONTROL STRINGEDIT
                            ;==== controlId:12296, containerId:12293, containerdata:12293   
                            ;----------------------------------------------------------
                            PROPERTIES
                              Name                #Overview_Description
                              DataSource          #DEV_CleanupTaskSettings
                              DataField           #Description
                            ENDPROPERTIES
                            
                          ENDCONTROL 
                          
                          CONTROL INTEDIT
                            ;==== controlId:12297, containerId:12293, containerdata:12293   
                            ;----------------------------------------------------------
                            PROPERTIES
                              Name                #Overview_CleanupDays
                              DataSource          #DEV_CleanupTaskSettings
                              DataField           #CleanupDays
                            ENDPROPERTIES
                            
                          ENDCONTROL 
                          
                          CONTROL REALEDIT
                            ;==== controlId:12298, containerId:12293, containerdata:12293   
                            ;----------------------------------------------------------
                            PROPERTIES
                              Name                #Overview_M_durationMin
                              AllowEdit           #No
                              HelpText            #Last execution duration(Min)
                              Label               #Last duration(Min)
                              DataSource          #DEV_CleanupTaskSettings
                              DataMethod          #durationMin
                              MinNoOfDecimals     #Auto
                            ENDPROPERTIES
                            
                          ENDCONTROL 
                          
                          CONTROL INTEDIT
                            ;==== controlId:12299, containerId:12293, containerdata:12293   
                            ;----------------------------------------------------------
                            PROPERTIES
                              Name                #Overview_LastUpdatedRecords
                              DataSource          #DEV_CleanupTaskSettings
                              DataField           #LastUpdatedRecords
                            ENDPROPERTIES
                            
                          ENDCONTROL 
                          
                        ENDCONTAINER
                        
                    ENDCONTROL 
                    
                  ENDCONTAINER
                  
              ENDCONTROL 
              
            ENDCONTAINER
            
          ENDCONTROL 
          
          CONTROL TABPAGE
            ;==== controlId:12300, containerId:12290, containerdata:12290   
            ;----------------------------------------------------------
            PROPERTIES
              Name                #TabPageGenral
              Width               #Column width
              Height              #Column height
              Caption             #@SYS2952
              Columns             #2
              ArrangeGuide        
                ARRAY INDEX Columns 
                  #0
                  #0
                ENDARRAY
            ENDPROPERTIES
            
            CONTAINER
              CONTROL GROUP
                ;==== controlId:12301, containerId:12300, containerdata:12300   
                ;----------------------------------------------------------
                PROPERTIES
                  Name                #StatusHistory
                  DataSource          #DEV_CleanupTaskSettings
                  DataGroup           #StatusHistory
                  AutoDataGroup       #Yes
                ENDPROPERTIES
                
                  CONTAINER
                  ENDCONTAINER
                  
              ENDCONTROL 
              
              CONTROL GROUP
                ;==== controlId:12302, containerId:12300, containerdata:12300   
                ;----------------------------------------------------------
                PROPERTIES
                  Name                #AdvancedSettings
                  DataSource          #DEV_CleanupTaskSettings
                  DataGroup           #AdvancedSettings
                  AutoDataGroup       #Yes
                ENDPROPERTIES
                
                  CONTAINER
                  ENDCONTAINER
                  
              ENDCONTROL 
              
            ENDCONTAINER
            
          ENDCONTROL 
          
        ENDCONTAINER
        
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        ;==== controlId:12303, containerId: 0, containerdata:12288   
        ;----------------------------------------------------------
        PROPERTIES
          Name                #ButtonGroup
        ENDPROPERTIES
        
        CONTAINER
          CONTROL BUTTON
            ;==== controlId:12304, containerId:12303, containerdata:12303   
            ;----------------------------------------------------------
            PROPERTIES
              Name                #EstimateButton
              HelpText            #Estimate number of records
              Text                #Estimate
            ENDPROPERTIES
            
            METHODS
              Version: 3
              SOURCE #clicked
                #void clicked()
                #{
                #    ;
                #    DEV_CleanupDataTaskProcessor::runEstimate(DEV_CleanupTaskSettings);
                #
                #}
              ENDSOURCE
            ENDMETHODS
          ENDCONTROL 
          
          CONTROL BUTTON
            ;==== controlId:12305, containerId:12303, containerdata:12303   
            ;----------------------------------------------------------
            PROPERTIES
              Name                #DisplaySQLButton
              HelpText            #Display task SQL
              Text                #Display SQL
            ENDPROPERTIES
            
            METHODS
              Version: 3
              SOURCE #clicked
                #void clicked()
                #{
                #    ;
                #    DEV_CleanupDataTaskProcessor::runDisplaySQL(DEV_CleanupTaskSettings);
                #
                #}
              ENDSOURCE
            ENDMETHODS
          ENDCONTROL 
          
          CONTROL MENUITEMBUTTON
            ;==== controlId:12306, containerId:12303, containerdata:12303   
            ;----------------------------------------------------------
            PROPERTIES
              Name                #DEV_CleanupDataTask
              Text                #Execute selected
              MenuItemType        #Action
              MenuItemName        #DEV_CleanupDataTaskProcessor
            ENDPROPERTIES
            
          ENDCONTROL 
          
        ENDCONTAINER
        
      ENDCONTROL 
      
    ENDCONTAINER
    
  ENDDESIGN
  
ENDFORM


***Element: FTM

; Microsoft Dynamics MENUITEM : DEV_CleanupTaskSettings unloaded
; --------------------------------------------------------------------------------
  VERSION 1
  
  MENUITEM #DEV_CleanupTaskSettings
    Type: 1
    PROPERTIES
      Name                #DEV_CleanupTaskSettings
      Label               #Cleanup settings
      HelpText            #Cleanup settings table
      Object              #DEV_CleanupTaskSettings
    ENDPROPERTIES
    
  ENDMENUITEM
  

***Element: FTM

; Microsoft Dynamics MENUITEM : DEV_CleanupDataTaskProcessor unloaded
; --------------------------------------------------------------------------------
  VERSION 1
  
  MENUITEM #DEV_CleanupDataTaskProcessor
    Type: 3
    PROPERTIES
      Name                #DEV_CleanupDataTaskProcessor
      Label               #Cleanup historic data
      HelpText            #Perform Cleanup historic data
      ObjectType          #Class
      Object              #DEV_CleanupDataTaskProcessor
      RunOn               #Server
    ENDPROPERTIES
    
  ENDMENUITEM
  

***Element: MNU

; Microsoft Dynamics Menu : Administration unloaded
; --------------------------------------------------------------------------------
  MNUVERSION 4
  
  MENU #Administration
    PROPERTIES
      Name                #Administration
      Label               #@SYS90142
      HelpText            #@SYS89034
      NormalResource      #3467
    ENDPROPERTIES
    
    MENUITEM
      PROPERTIES
        Name                #Users
        MenuItemName        #SysUserInfo
      ENDPROPERTIES
      
    ENDMENUITEM
    MENUITEM
      PROPERTIES
        Name                #Online users
        MenuItemName        #SysUsersOnline
      ENDPROPERTIES
      
    ENDMENUITEM
    MENUITEM
      PROPERTIES
        Name                #Company accounts
        MenuItemName        #SysDataArea
      ENDPROPERTIES
      
    ENDMENUITEM
    MENU #@SYS3850
      PROPERTIES
        Name                #Submenu1
        Label               #@SYS3850
        HelpText            #@SYS72305
      ENDPROPERTIES
      
      MENUITEM
        PROPERTIES
          Name                #User log
          MenuItemName        #SysUserLog
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Database log
          MenuItemName        #SysDataBaseLog
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Electronic signature log
          MenuItemName        #SysSignLog
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #User permissions
          MenuItemName        #SysUserSecurity
        ENDPROPERTIES
        
      ENDMENUITEM
      MENU #@SYS14291
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS14291
          HelpText            #@SYS72313
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #SQL statement trace log
            MenuItemName        #SysTraceSQL
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Database information
            MenuItemName        #SysSqlStatus
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Locking database users
            MenuItemName        #SysSQLBlockingMSSQL
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
    ENDMENU
    MENU #@SYS6845
      PROPERTIES
        Name                #Submenu1
        Label               #@SYS6845
        HelpText            #@SYS72306
      ENDPROPERTIES
      
      MENUITEM
        PROPERTIES
          Name                #Tables
          MenuItemType        #Output
          MenuItemName        #SysDataAreaPrintCollections
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Database information
          MenuItemType        #Output
          MenuItemName        #SysSqlStatus
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Database log
          MenuItemType        #Output
          MenuItemName        #SysDatabaseLog
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Size of company accounts
          MenuItemType        #Output
          MenuItemName        #SysCompanySize
        ENDPROPERTIES
        
      ENDMENUITEM
      MENU #@SYS58046
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS58046
          HelpText            #@SYS72311
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #User permissions
            MenuItemType        #Output
            MenuItemName        #SysUserSecurity
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #User group permissions
            MenuItemType        #Output
            MenuItemName        #SysUserGroupSecurity
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Record level security
            MenuItemType        #Output
            MenuItemName        #SysRecordLevelSecurity
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Last logon
            MenuItemType        #Output
            MenuItemName        #SysUserLogin
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Online time
            MenuItemType        #Output
            MenuItemName        #SysUsersOnlineReport
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
    ENDMENU
    MENU #@SYS8782
      PROPERTIES
        Name                #Submenu1
        Label               #@SYS8782
        HelpText            #@SYS72307
      ENDPROPERTIES
      
      MENUITEM
        PROPERTIES
          Name                #Refresh Data Cache
          MenuItemType        #Action
          MenuItemName        #SAB_FlushClientCache_WIK
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #E-mail broadcast
          MenuItemType        #Action
          MenuItemName        #sysemailBroadcast
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Compile application
          MenuItemType        #Action
          MenuItemName        #SysCompileAll
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #SQL Administration
          MenuItemName        #SysSqlAdmin
        ENDPROPERTIES
        
      ENDMENUITEM
      MENU #@SYS24570
        PROPERTIES
          Name                #@SYS65294
          Label               #@SYS24570
          HelpText            #@SYS72314
          NeededAccessLevel   #NoAccess
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #Definition groups
            MenuItemName        #SysExpImpGroup
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Export
            MenuItemType        #Action
            MenuItemName        #SysDataExport
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Import
            MenuItemType        #Action
            MenuItemName        #SysDataImport
          ENDPROPERTIES
          
        ENDMENUITEM
        MENU #@SYS67125
          PROPERTIES
            Name                #@SYS67125
            Label               #@SYS67125
            HelpText            #@SYS72327
            NeededAccessLevel   #NoAccess
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Export
              MenuItemType        #Action
              MenuItemName        #SysDefaultDataExport
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Import Wizard
              MenuItemName        #SysDefaultDataImportWizard
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
        MENU #@SYS57521
          PROPERTIES
            Name                #@SYS59217
            Label               #@SYS57521
            HelpText            #@SYS72328
            NeededAccessLevel   #NoAccess
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Template Wizard
              MenuItemName        #sysExcelTemplateWizard
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Excel export
              MenuItemType        #Action
              MenuItemName        #SysDataExportExcel
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Excel import
              MenuItemType        #Action
              MenuItemName        #SysDataImportExcel
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
      ENDMENU
      MENU #@SAB1210
        PROPERTIES
          Name                #SAB_TableExport
          Label               #@SAB1210
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #Table Export
            MenuItemType        #Action
            MenuItemName        #SAB_TBEExport
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Table Export
            MenuItemName        #SAB_TBEExportTable
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
      MENU #@SYS94772
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS94772
          HelpText            #@SYS74046
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #E-mail sending status
            MenuItemName        #SysOutgoingEmailTable
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Retry Schedule
            MenuItemName        #SysEmailRetrySchedule
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Batch
            MenuItemType        #Action
            MenuItemName        #SysEmailDistributor
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
      MENU #@SYS72720
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS72720
          HelpText            #@SYS89034
          ConfigurationKey    #Currency
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #Company currency conversion
            MenuItemName        #ConvCompanyCurrency
          ENDPROPERTIES
          
        ENDMENUITEM
        MENU #@SYS24056
          PROPERTIES
            Name                #Submenu2
            Label               #@SYS24056
            HelpText            #@SYS89034
            ConfigurationKey    #Currency
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Check ledger transactions
              MenuItemType        #Output
              MenuItemName        #LedgerCheckTrans
            ENDPROPERTIES
            
          ENDMENUITEM
          MENU #@SYS69067
            PROPERTIES
              Name                #Submenu1
              Label               #@SYS69067
              HelpText            #@SYS89034
            ENDPROPERTIES
            
            MENUITEM
              PROPERTIES
                Name                #GST
                MenuItemType        #Output
                MenuItemName        #TaxReport_LedgerReconciliation
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Bank
                MenuItemType        #Output
                MenuItemName        #BankLedgerReconciliation
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Customer
                MenuItemType        #Output
                MenuItemName        #CustLedgerReconciliation
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Vendor
                MenuItemType        #Output
                MenuItemName        #VendLedgerReconciliation
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Inventory
                MenuItemType        #Output
                MenuItemName        #InventLedgerConciliation
              ENDPROPERTIES
              
            ENDMENUITEM
          ENDMENU
          MENU #@SYS4946
            PROPERTIES
              Name                #Submenu1
              Label               #@SYS4946
              HelpText            #@SYS89034
            ENDPROPERTIES
            
            MENUITEM
              PROPERTIES
                Name                #Customer
                MenuItemType        #Output
                MenuItemName        #CustReport_CheckSettlement
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Vendor
                MenuItemType        #Output
                MenuItemName        #VendReport_CheckSettlement
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Inventory
                MenuItemType        #Output
                MenuItemName        #InventReport_CheckSettlement
              ENDPROPERTIES
              
            ENDMENUITEM
          ENDMENU
        ENDMENU
        MENU #@SYS75643
          PROPERTIES
            Name                #Submenu1
            Label               #@SYS75643
            HelpText            #@SYS89034
            ConfigurationKey    #Currency
            NeededAccessLevel   #Delete
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Journalising
              MenuItemType        #Action
              MenuItemName        #LedgerJournalizeTrans
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Business statistics
              MenuItemName        #BusinessStatisticsDef
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
      ENDMENU
      MENU #@SYS71045
        PROPERTIES
          Name                #@SYS71045
          Label               #@SYS71045
          HelpText            #@SYS72321
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #Update models
            MenuItemType        #Action
            MenuItemName        #SRSUpdateModelsMenuItem
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Create all Secure Views
            MenuItemType        #Action
            MenuItemName        #SRSSecureViewBatchJob
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
      MENU #Data cleanup
        PROPERTIES
          Name                #DataCleanup
          Label               #Data cleanup
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #Cleanup settings
            MenuItemName        #DEV_CleanupTaskSettings
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Cleanup historic data
            MenuItemType        #Action
            MenuItemName        #DEV_CleanupDataTaskProcessor
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
    ENDMENU
    MENU #@SYS2186
      PROPERTIES
        Name                #@SYS2186
        Label               #@SYS2186
        HelpText            #@SYS72309
      ENDPROPERTIES
      
      MENUITEM
        PROPERTIES
          Name                #User groups
          MenuItemName        #SysUserGroupInfo
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #User relations
          MenuItemName        #SysCompanyUserInfo
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Domains
          MenuItemName        #SysDomainInfo
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Virtual company accounts
          MenuItemName        #SysDataAreaVirtual
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Database log
          MenuItemName        #SAB_ExtDatabaseLogSetup
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                # Electronic signature audit trail
          MenuItemName        #SysDatabaseLogTableSetup
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Oracle setup
          MenuItemName        #SysSqlAdminOracle
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #E-mail parameters
          MenuItemName        #SysEmailParameters
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Help Update parameters
          MenuItemName        #SysHelpParameters
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Electronic signature
          MenuItemName        #SysSignTable
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Session parameters
          MenuItemName        #SAB_DefaultSessionParameters
        ENDPROPERTIES
        
      ENDMENUITEM
      MENUITEM
        PROPERTIES
          Name                #Report e-mail parameters
          MenuItemName        #DYX_ReportMailParameters
        ENDPROPERTIES
        
      ENDMENUITEM
      MENU #@SYS71045
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS71045
          HelpText            #@SYS72321
        ENDPROPERTIES
        
        MENU #@SYS71147
          PROPERTIES
            Name                #Submenu1
            Label               #@SYS71147
            HelpText            #@SYS89034
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Business views
              MenuItemName        #BASViewTable
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Groupings
              MenuItemName        #BASGrouping
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Calculated fields
              MenuItemName        #BASCalcTable
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Company collections
              MenuItemName        #BASCompanyCollection
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Enumerated labels
              MenuItemName        #BASEnumTable
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Parameters
              MenuItemName        #BASParameters
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
        MENU #@SYS25984
          PROPERTIES
            Name                #Submenu1
            Label               #@SYS25984
            HelpText            #@SYS72326
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Cube Definition Manager
              MenuItemName        #OLAPCDM
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #OLAP servers
              MenuItemName        #OLAPServerTable
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
        MENU #@SYS88407
          PROPERTIES
            Name                #Submenu1
            Label               #@SYS88407
            HelpText            #@SYS88478
            ConfigurationKey    #ReportingServices
            SecurityKey         #AdminSetup
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Reporting Servers
              MenuItemName        #SRSReportingServicesServersMenuItem
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Model generation options
              MenuItemName        #SRSModelGenerationOptionsMenuItem
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
      ENDMENU
      MENU #@SYS58046
        PROPERTIES
          Name                #@SYS58093
          Label               #@SYS58046
          HelpText            #@SYS72322
          NeededAccessLevel   #NoAccess
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #User group permissions
            MenuItemName        #SysUserGroupSecurity
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Record level security
            MenuItemName        #sysrecordlevelSecurity
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Business Connector Proxy
            MenuItemName        #sysbusinessConnectorProxy
          ENDPROPERTIES
          
        ENDMENUITEM
      ENDMENU
      MENU #@SYS4278
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS4278
          HelpText            #@SYS72323
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #Licence information
            MenuItemName        #SysLicenseCode
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Configuration
            MenuItemName        #SysConfiguration
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Adjust global types
            MenuItemName        #SysEDTSetup
          ENDPROPERTIES
          
        ENDMENUITEM
        MENUITEM
          PROPERTIES
            Name                #Concurrency model configuration
            MenuItemName        #SysOccConfiguration
          ENDPROPERTIES
          
        ENDMENUITEM
        MENU #@SYS72949
          PROPERTIES
            Name                #Submenu1
            Label               #@SYS72949
            HelpText            #@SYS72950
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Installation checklist
              MenuItemName        #SysCheckList_Setup
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Upgrade checklist
              MenuItemName        #SysCheckList_Upgrade
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #GL Project checklist
              MenuItemName        #SysCheckList_GLProject
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #VCS Setup checklist
              MenuItemName        #SysCheckList_VCS
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Prevent startup of lists
              MenuItemType        #Action
              MenuItemName        #SysCheckList_InitNoUpdate
            ENDPROPERTIES
            
          ENDMENUITEM
        ENDMENU
      ENDMENU
      MENU #@SYS50857
        PROPERTIES
          Name                #Submenu1
          Label               #@SYS50857
          HelpText            #@SYS72324
        ENDPROPERTIES
        
        MENUITEM
          PROPERTIES
            Name                #External Web users
            MenuItemName        #SysEPParameters
          ENDPROPERTIES
          
        ENDMENUITEM
        MENU #@SYS70936
          PROPERTIES
            Name                #Submenu1
            Label               #@SYS70936
            HelpText            #@SYS72330
          ENDPROPERTIES
          
          MENUITEM
            PROPERTIES
              Name                #Configuration wizard
              MenuItemName        #EPSetupWizard
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Manage deployments
              MenuItemName        #EPWizard
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Publish images
              MenuItemName        #EPPublishImages
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Web sites
              MenuItemName        #WebSite
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Transaction summary
              MenuItemType        #Action
              MenuItemName        #EPTransactionSum
            ENDPROPERTIES
            
          ENDMENUITEM
          MENUITEM
            PROPERTIES
              Name                #Parameters
              MenuItemName        #EPParameters
            ENDPROPERTIES
            
          ENDMENUITEM
          MENU #@SYS58654
            PROPERTIES
              Name                #@SYS58654
              Label               #@SYS58654
              HelpText            #@SYS72329
            ENDPROPERTIES
            
            MENUITEM
              PROPERTIES
                Name                #Sales basket
                MenuItemName        #ECPBasket
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Sign up
                MenuItemName        #ECPCustSignUpRequest
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Parameters
                MenuItemName        #ECPParameters
              ENDPROPERTIES
              
            ENDMENUITEM
          ENDMENU
          MENU #@SYS73748
            PROPERTIES
              Name                #Submenu1
              Label               #@SYS73748
              HelpText            #@SYS89034
            ENDPROPERTIES
            
            MENUITEM
              PROPERTIES
                Name                #Product groups
                MenuItemName        #InventProductGroupItem
              ENDPROPERTIES
              
            ENDMENUITEM
            MENUITEM
              PROPERTIES
                Name                #Presentations
                MenuItemName        #ECPpresentation
              ENDPROPERTIES
              
            ENDMENUITEM
          ENDMENU
        ENDMENU
      ENDMENU
    ENDMENU
  ENDMENU
  

***Element: PRN

; Microsoft Dynamics Project : DEV_PerfAuditDataCleanUp2 unloaded
; --------------------------------------------------------------------------------
  PROJECTVERSION 2
  
  PROJECT #DEV_PerfAuditDataCleanUp2
   SHARED
  PROPERTIES
    Name                #DEV_PerfAuditDataCleanUp2
  ENDPROPERTIES
  
    GROUP #Data_Dictionary
      PROPERTIES
        Name                #Data_Dictionary
        ProjectGroupType    #DataDictionary
        GroupMask           #
        PreventEditProperties #No
      ENDPROPERTIES
      
      GROUP #Tables
        PROPERTIES
          Name                #Tables
          ProjectGroupType    #Tables
          GroupMask           #
          PreventEditProperties #No
        ENDPROPERTIES
        
        BEGINNODE
          FILETYPE 0
          UTILTYPE 44
          UTILOBJECTID 30358
          NODETYPE 204
          NAME #DEV_CleanupTaskSettings
        ENDNODE
        ENDGROUP
        
      GROUP #Extended_Data_Types
        PROPERTIES
          Name                #Extended_Data_Types
          ProjectGroupType    #ExtendedDataTypes
          GroupMask           #
          PreventEditProperties #No
        ENDPROPERTIES
        
        BEGINNODE
          FILETYPE 0
          UTILTYPE 41
          UTILOBJECTID 31041
          NODETYPE 234
          NAME #DEV_CleanUpTaskName
        ENDNODE
        ENDGROUP
        
      GROUP #BaseEnums
        PROPERTIES
          Name                #BaseEnums
          ProjectGroupType    #BaseEnums
          GroupMask           #
          PreventEditProperties #No
        ENDPROPERTIES
        
        BEGINNODE
          FILETYPE 0
          UTILTYPE 40
          UTILOBJECTID 30219
          NODETYPE 209
          NAME #DEV_CleanupRunMode
        ENDNODE
        ENDGROUP
        
      ENDGROUP
      
    GROUP #Classes
      PROPERTIES
        Name                #Classes
        ProjectGroupType    #Classes
        GroupMask           #
        PreventEditProperties #No
      ENDPROPERTIES
      
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30492
        NODETYPE 329
        NAME #DEV_CleanupDataTask_SalesParmTables
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30490
        NODETYPE 329
        NAME #DEV_CleanupDataTask_InventSumClosed
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30489
        NODETYPE 329
        NAME #DEV_CleanupDataTask_BatchHistory
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30493
        NODETYPE 329
        NAME #DEV_CleanupDataTask_SysDatabaseLog
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30491
        NODETYPE 329
        NAME #DEV_CleanupDataTask_PurchParmTable
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30488
        NODETYPE 329
        NAME #DEV_CleanupDataSQLBuider
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30495
        NODETYPE 329
        NAME #DEV_CleanupDataTaskProcessor
      ENDNODE
      BEGINNODE
        FILETYPE 0
        UTILTYPE 45
        UTILOBJECTID 30494
        NODETYPE 329
        NAME #DEV_CleanupDataTaskBase
      ENDNODE
      ENDGROUP
      
    GROUP #Forms
      PROPERTIES
        Name                #Forms
        ProjectGroupType    #Forms
        GroupMask           #
        PreventEditProperties #No
      ENDPROPERTIES
      
      BEGINNODE
        FILETYPE 0
        UTILTYPE 11
        UTILOBJECTID 0
        NODETYPE 201
        NAME #DEV_CleanupTaskSettings
      ENDNODE
      ENDGROUP
      
    GROUP #Menu_Items
      PROPERTIES
        Name                #Menu_Items
        ProjectGroupType    #MenuItems
        GroupMask           #
        PreventEditProperties #No
      ENDPROPERTIES
      
      GROUP #Display
        PROPERTIES
          Name                #Display
          ProjectGroupType    #Display
          GroupMask           #
          PreventEditProperties #No
        ENDPROPERTIES
        
        BEGINNODE
          FILETYPE 0
          UTILTYPE 1
          UTILOBJECTID 0
          NODETYPE 296
          NAME #DEV_CleanupTaskSettings
        ENDNODE
        ENDGROUP
        
      GROUP #Action
        PROPERTIES
          Name                #Action
          ProjectGroupType    #Action
          GroupMask           #
          PreventEditProperties #No
        ENDPROPERTIES
        
        BEGINNODE
          FILETYPE 0
          UTILTYPE 3
          UTILOBJECTID 0
          NODETYPE 296
          NAME #DEV_CleanupDataTaskProcessor
        ENDNODE
        ENDGROUP
        
      ENDGROUP
      
    GROUP #Menus
      PROPERTIES
        Name                #Menus
        ProjectGroupType    #
        GroupMask           #
        PreventEditProperties #No
      ENDPROPERTIES
      
      BEGINNODE
        FILETYPE 0
        UTILTYPE 16
        UTILOBJECTID 0
        NODETYPE 205
        NAME #Administration
      ENDNODE
      ENDGROUP
      
  ENDPROJECT
  

***Element: END
